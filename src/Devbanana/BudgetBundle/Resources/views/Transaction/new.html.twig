{% extends "::base.html.twig" %}

{% block title %}Add Transaction{% endblock %}

{% block stylesheets %}
<link style="text/css" rel="stylesheet"
href="{{ asset('bundles/devbananabudget/js/jquery-ui/jquery-ui.min.css') }}">
{% endblock %}

{% block body %}
<h1>Add Transaction</h1>

<div id="alert" style="display:none;"></div>

<div id="transaction-form">
{{ form_start(form) }}

<table border="0" cellpadding="3" cellspacing="3">
<thead>
<tr>
<th id="date-label">Date</th>
<th id="inflow-label">Inflow</th>
<th id="outflow-label">Outflow</th>
<th id="balance-label">Balance</th>
</tr>
</thead>

<tbody>
<tr>
<td aria-labelledby="date-label">
{{ form_widget(form.date) }}
</td>
<td aria-labelledby="inflow-label">
<span id="inflow">$0.00</span>
</td>
<td aria-labelledby="outflow-label">
<span id="outflow">$0.00</span>
</td>
<td aria-labelledby="balance-label">
<span id="balance" aria-live="polite">$0.00</span>
</td>
</tr>
</table>

<h2>Line Items</h2>

<table border="1" rules="rows" cellpadding="3" cellspacing="3">
<thead>
<tr>
<th>Type</th>
<th>Account</th>
<th>Payer/Payee</th>
<th>Category</th>
<th>Memo</th>
<th>Inflow</th>
<th>Outflow</th>
</tr>
</thead>

<tbody class="lineitems" data-prototype="
{{ '<td class="type">'|e }}
{{ form_widget(form.lineitems.vars.prototype.type)|e }}
{{ '</td>'|e }}
{{ '<td class="account">'|e }}
{{ form_widget(form.lineitems.vars.prototype.account)|e }}
{{ '</td>'|e }}
{{ '<td class="payee">'|e }}
{{ form_widget(form.lineitems.vars.prototype.payee)|e }}
{{ '</td>'|e }}
{{ '<td class="category">'|e }}
{{ form_widget(form.lineitems.vars.prototype.category)|e }}
{{ '</td>'|e }}
{{ '<td class="memo">'|e }}
{{ form_widget(form.lineitems.vars.prototype.memo)|e }}
{{ '</td>'|e }}
{{ '<td class="inflow">'|e }}
{{ form_widget(form.lineitems.vars.prototype.inflow)|e }}
{{ '</td>'|e }}
{{ '<td class="outflow">'|e }}
{{ form_widget(form.lineitems.vars.prototype.outflow)|e }}
{{ '</td>'|e }}
">
{% for lineitem in form.lineitems %}
<tr class="lineitem">
<td class="type">
{{ form_widget(lineitem.type) }}
</td>
<td class="account">
{{ form_widget(lineitem.account) }}
</td>
<td class="payee">
{{ form_widget(lineitem.payee) }}
</td>
<td class="category">
{{ form_widget(lineitem.category) }}
</td>
<td class="memo">
{{ form_widget(lineitem.memo) }}
</td>
<td class="inflow">
{{ form_widget(lineitem.inflow) }}
</td>
<td class="outflow">
{{ form_widget(lineitem.outflow) }}
</td>
</tr>
{% do lineitem.payer.setRendered %}
{% do lineitem.assignedMonth.setRendered %}
{% do lineitem.transferAccount.setRendered %}
{% endfor %}
</tbody>
</table>

<p><button id="submit">Add</button></p>
{{ form_end(form) }}
</div>

{# Dialogs #}
<div id="account_dialog" title="Add Account" style="display:none;" role="dialog"></div>
<div id="payee_dialog" title="Add a Payee" style="display:none;" role="dialog"></div>
<div id="new-category" role="dialog" title="Add a Category" style="display:none;"></div>
{% endblock %}

{% block javascripts %}
<script type="text/javascript" src="{{ asset('bundles/devbananabudget/js/account.js') }}"></script>
<script type="text/javascript" src="{{ asset('bundles/devbananabudget/js/transaction-form.js') }}"></script>
{% endblock %}
